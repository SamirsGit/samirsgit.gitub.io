---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
lng_pair: id_autogeneratedsamplecontent_5
title: "Splunk vs. Neris Botnet"

# post specific
# if not specified, .name will be used from _data/owner/[language].yml
#author: "Samir A."
# multiple category is not supported
category: auto generated
# multiple tag entries are possible
tags: [jekyll, test]
# thumbnail image for post
img: ":splunk.png"
# disable comments on this page
comments_disable: true

# publish date
date: 2024-10-15 18:47:35 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2021-10-14 18:47:35 +0900
# check the meta_common_description in _data/owner/[language].yml
#meta_description: ""

# optional
# please use the "image_viewer_on" below to enable image viewer for individual pages or posts (_posts/ or [language]/_posts folders).
# image viewer can be enabled or disabled for all posts using the "image_viewer_posts: true" setting in _data/conf/main.yml.
#image_viewer_on: true
# please use the "image_lazy_loader_on" below to enable image lazy loader for individual pages or posts (_posts/ or [language]/_posts folders).
# image lazy loader can be enabled or disabled for all posts using the "image_lazy_loader_posts: true" setting in _data/conf/main.yml.
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---
### Neris Botnet 

**Botnet** is a network of compromised computers that communicate with a central C&C server with the HTTP protocol. Neris Botnets are known to distribute malicious .exe files for infections.  When reviewing HTTP content type it's important to look for 'application/octet-stream' which indicates the transfer of binary data. You may also see a text file, probably because this includes configurations or instructions for the malware. 

____________________________________________________________________________________________________________________________________________________________________________________________

**Q1** Unusual patterns of activity were observed in Suricata logs. One external IP initiated access and was fond downloading a suspicious executable file. What is the IP address from which this unauthorized access originated? 

- **Eventtype** field groups similar events together based on specific search patterns. This will allow you to search for specific types of events with a low chance of altering the raw data, which is a risk when using complex search queries each time. In this lab, the eventtype suricata_eve_ids_attack seems to a good option.

![Splunk](:004_splunk1.png){:data-align="center"}

- **Statistics** this tab is used to perform quantitative analysis on data to help summarize and analyze large datasets in values such as averages, sums, counts, and more. There are multiple fields, in your query pick the ones that are most applicable. 

![Splunk](:004_splunk2.png){:data-align="center"}

- **Src_ip** = 195.88.191.59

**Q2** What is the domain name of the attacker server? 

- **Domain**: nocomcom.com, found in previous values under HTTP hostname, also known as the Command & Control domain in this scenario.

**Note:** 

**Q3** What is the IP address of the targeted system in this breach?

![Splunk](:004_splunk3.png){:data-align="center"}

**Q4** Identify the unique files downloaded to the compromised host. How many of these files could be potentially malicious? 

Answer: all 5, why? .exe are typically executable programs, which are common payloads for malware distribution, especially when you see its in the /temp directory. The .txt as well, appears less suspicious and help botnets evade detection by automated systems. 

**Q5** What is the SHA256 hash of the malicious file disguised as a .txt file? 

![Splunk](:004_splunk4.png){:data-align="center"}

- **Virus Total** 

![Splunk](:004_splunk5.png){:data-align="center"}

SHA256 hash: 6fbc4d506f4d4e0a64ca09fd826408d3103c1a258c370553583a07a4cb9a6530
