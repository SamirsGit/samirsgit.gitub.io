---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
lng_pair: id_autogeneratedsamplecontent_5
title: "SOC: Automation Homelab"

# post specific
# if not specified, .name will be used from _data/owner/[language].yml
#author: "Samir A."
# multiple category is not supported
category: auto generated
# multiple tag entries are possible
tags: [jekyll, test]
# thumbnail image for post
img: ":splunk.png"
# disable comments on this page
comments_disable: true

# publish date
date: 2024-10-15 18:47:35 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2021-10-14 18:47:35 +0900
# check the meta_common_description in _data/owner/[language].yml
#meta_description: ""

# optional
# please use the "image_viewer_on" below to enable image viewer for individual pages or posts (_posts/ or [language]/_posts folders).
# image viewer can be enabled or disabled for all posts using the "image_viewer_posts: true" setting in _data/conf/main.yml.
#image_viewer_on: true
# please use the "image_lazy_loader_on" below to enable image lazy loader for individual pages or posts (_posts/ or [language]/_posts folders).
# image lazy loader can be enabled or disabled for all posts using the "image_lazy_loader_posts: true" setting in _data/conf/main.yml.
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---
### Security Operation Center: Automation Homelab Configuration

- **Objective:** Security Operation Centers (SOC) are commonly centralized units that monitor, prevent, detect, investigate, and repsond to cyber threats on a 24/7 basis.
- **Common Roles: **SOC Manager, SOC Analyst, SOC Engineers, Incident Responders, Threat Hunters, Forensic Analysts, Vulnerability Analysts, Data Analysts, Threat Intel Analysts, Compliance Specialists,  
- **Typical components**: SIEM, IDS/IPS, XDR, Firewalls, SOAR, Vulnerability Scanners, Network Monitoring Tools, Log Management, Ticketing, DLP, Active Directory

- In this lab, we will be using _Wazuh_ as the SIEM and XDR, _Shuffle_ as the SOAR, _Virtual Total_ as an enrichment source for IoCs, and _TheHive_ as a case management platform. Telemetry will be generated from the Wazuh Agent, for this example we will use mimikatz.exe, but there will be a future lab focused on red teaming this blue team environment to see how we can further improve the security stance. 

**Lab Topology:**

![Splunk](:006_soc3.png){:data-align="center"}

**Telemetry** - sensors collect data from equipment, this data is transmitted via a path to designated receiving equipment, which then processes and analyzes the data then present it.

### Wazuh Agent & Manager & TheHive

**Wazuh Agent** - ensure that you check to see which operating systems Wazuh agents support. In this example, I want to use Windows and Wazuh supports all ediitions of Windows 10. Proceeding, you will need to find an .iso file. Also, I will be hosting this iso image in VMWare Workstation Pro 17. I enjoy using all kinds of hypervisors, I noticed this one has 33% market share so I thought it would be worthwhile to use.  

- **Sysmon** (System Monitor) this Windows system service and device driver will monitor and log system activity to help identify what's going on within the network. This is a part of Sysinternals, which is owned by Microsoft. The details included will be process creations, network connections, file creation and deletion, file creation time changes, driver and DLL loading, raw disk access, registry events, image load, pipe evens, WMI events. Storage: 128 GB, RAM: 4 GB, Processors: 1. Ensure you later download VMware Tools to add helpful functionalities. 

![Splunk](:006_soc4.png){:data-align="center"}

- Download Sysmon > Save sysmonconfig.xml > run PowerShell as admin > verify Sysmon64 is running 

![Splunk](:006_soc7.png){:data-align="center"}

- We have a fully functional VM and were able to verify the proper services are running.

![Splunk](:006_soc6.png){:data-align="center"} 

**Wazuh: Security Guard** components include the Wazuh Manager / Server, Agent, Indexer, and Dashboard. Agents are installed on endpoints, the Manager receives a variety of data from the agents, indexers is a search engine that stores alerts generated by the Manager. Finally, the Dashbpard provides an interface for user friendly data visualization, analysis, and management.
- Detection and monitoring of security events  

**TheHive: Incident Manager** allows users to create and manage cases, it consists of TheHive Server, Cortex as an analysis engine to observe analyzers, and Malware Information Sharing Platform (MISP) integrations.
-  MISP is Threat intelligence sharing > Threat Indicators, IoCs, TTPs, Contexual Threat Data >> shared IoCs and collective intelligence 
-  Virus Total is malware and URL analysis > Files, URLs, Hashes, Analysis Reports >> Integrate malware analysis into security workflows via API
-  Cortex is automated analysis and response > Observables (IPs, Hashes), analysis results >> automate analysis of security observables 
-  TheHive incident response and case management > Incidents, Alerts, Case Details, Evidence >> team collaboration and response coordination

![Splunk](:006_soc9.png){:data-align="center"}

**Digital Ocean** this platform is for deploying, managing, and scaling applications. It has an interface that can be used in tandem with a variety of tools to manage the cloud infrastructure efficiently. For the next project I will use Proxmox and will set it up as a red team against this blue team environment. 
- Location: can be your preferred data center location
- Operating systems: Ubuntu 22.04 LTS >> LTS means Long-Term Support, leads to a more stable environment
- Resources - each droplet must be 8 GB of memory for Wazuh & TheHive
- Authentication - I chose pasword, but you can select SSH key if you'd like.
- **Droplet** - scalable VM that runs on top of virtualized hardware. Each droplet is like an independent server used to host websites, databases, and host applications. 

![Splunk](:006_soc8.png){:data-align="center"}

- SSH into the server using the public IP address.

![Splunk](:006_soc8.png){:data-align="center"}
